# =============================================================================
# COCKPIT ACCESS CONTROL CONFIGURATION
# =============================================================================
# Generated by Ansible - kvmhost_cockpit role
# Modification timestamp: {{ ansible_date_time.iso8601 }}

[Access]
# User access control
{% if kvmhost_cockpit_allowed_users | length > 0 %}
# Allowed users
{% for user in kvmhost_cockpit_allowed_users %}
allow-user={{ user }}
{% endfor %}
{% endif %}

{% if kvmhost_cockpit_admin_users | length > 0 %}
# Administrative users
{% for user in kvmhost_cockpit_admin_users %}
admin-user={{ user }}
{% endfor %}
{% endif %}

# Default access policy
{% if kvmhost_cockpit_default_access is defined %}
default-access={{ kvmhost_cockpit_default_access }}
{% else %}
default-access=allow
{% endif %}

[Privileges]
# Role-based access control
{% if kvmhost_cockpit_user_roles is defined and kvmhost_cockpit_user_roles %}
{% for role, users in kvmhost_cockpit_user_roles.items() %}
{{ role }}={{ users | join(',') }}
{% endfor %}
{% endif %}

# Module access restrictions
{% if kvmhost_cockpit_module_restrictions is defined and kvmhost_cockpit_module_restrictions %}
{% for module, users in kvmhost_cockpit_module_restrictions.items() %}
{{ module }}-access={{ users | join(',') }}
{% endfor %}
{% endif %}
