# =============================================================================
# COCKPIT AUTHENTICATION CONFIGURATION
# =============================================================================
# Generated by Ansible - kvmhost_cockpit role
# Modification timestamp: {{ ansible_date_time.iso8601 }}

[Basic]
# Authentication methods
{% if 'password' in kvmhost_cockpit_auth_methods %}
auth-type=basic
{% endif %}

{% if 'certificate' in kvmhost_cockpit_auth_methods %}
auth-type=certificate
{% endif %}

[Session]
# Session configuration
{% if kvmhost_cockpit_session_timeout is defined %}
timeout={{ kvmhost_cockpit_session_timeout }}
{% endif %}

{% if kvmhost_cockpit_max_sessions is defined %}
max-sessions={{ kvmhost_cockpit_max_sessions }}
{% endif %}

[Access]
# User access restrictions
{% if kvmhost_cockpit_allowed_users | length > 0 %}
allowed-users={{ kvmhost_cockpit_allowed_users | join(',') }}
{% endif %}

{% if kvmhost_cockpit_admin_users | length > 0 %}
admin-users={{ kvmhost_cockpit_admin_users | join(',') }}
{% endif %}

# Login attempts
{% if kvmhost_cockpit_max_login_attempts is defined %}
max-login-attempts={{ kvmhost_cockpit_max_login_attempts }}
{% endif %}

{% if kvmhost_cockpit_login_timeout is defined %}
login-timeout={{ kvmhost_cockpit_login_timeout }}
{% endif %}
